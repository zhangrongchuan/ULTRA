23:07:06   Random seed: 1024
23:07:06   Config file: config/transductive/inference.yaml
23:07:06   {'checkpoint': None,
 'dataset': {'class': 'RelBenchF1',
             'root': '/mnt/nfs/home/st191486/ULTRA/datasets/'},
 'model': {'class': 'Ultra',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'EntityNBFNet',
                            'hidden_dims': [64, 64, 64, 64, 64, 64],
                            'input_dim': 64,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'RelNBFNet',
                              'hidden_dims': [64, 64, 64, 64, 64, 64],
                              'input_dim': 64,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/mnt/nfs/home/st191486/ULTRA/output/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'TransductiveInference',
          'num_negative': 0,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 16,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 20}}
23:07:06   RelBenchF1 dataset
23:07:06   #train: 1353, #valid: 588, #test: 588
23:07:06   ------------------------------
23:07:06   Number of parameters: 185475
23:07:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:07:06   Epoch 0 begin
23:07:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:07:52   cross entropy: 1.33034
23:08:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:08:19   Epoch 0 end
23:08:19   ------------------------------
23:08:19   average binary cross entropy: 0.49797
23:08:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:08:19   Epoch 1 begin
23:08:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:08:24   cross entropy: 0.462468
23:08:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:08:47   Epoch 1 end
23:08:47   ------------------------------
23:08:47   average binary cross entropy: 0.272832
23:08:47   Save checkpoint to model_epoch_2.pth
23:08:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:08:47   Evaluate on valid (AUROC)
23:08:52   Valid AUROC: 0.558671
23:08:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:08:52   Epoch 2 begin
23:09:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:09:02   cross entropy: 0.0280913
23:09:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:09:20   Epoch 2 end
23:09:20   ------------------------------
23:09:20   average binary cross entropy: 0.166228
23:09:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:09:20   Epoch 3 begin
23:09:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:09:35   cross entropy: 0.281713
23:09:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:09:48   Epoch 3 end
23:09:48   ------------------------------
23:09:48   average binary cross entropy: 0.125674
23:09:48   Save checkpoint to model_epoch_4.pth
23:09:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:09:48   Evaluate on valid (AUROC)
23:09:53   Valid AUROC: 0.553403
23:09:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:09:53   Epoch 4 begin
23:10:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:10:13   cross entropy: 0.00713308
23:10:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:10:21   Epoch 4 end
23:10:21   ------------------------------
23:10:21   average binary cross entropy: 0.0735603
23:10:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:10:21   Epoch 5 begin
23:10:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:10:46   cross entropy: 0.00221119
23:10:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:10:49   Epoch 5 end
23:10:49   ------------------------------
23:10:49   average binary cross entropy: 0.0106796
23:10:49   Save checkpoint to model_epoch_6.pth
23:10:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:10:49   Evaluate on valid (AUROC)
23:10:54   Valid AUROC: 0.878178
23:10:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:10:54   Epoch 6 begin
23:11:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:11:22   Epoch 6 end
23:11:22   ------------------------------
23:11:22   average binary cross entropy: 0.000591503
23:11:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:11:22   Epoch 7 begin
23:11:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:11:24   cross entropy: 0.000273591
23:11:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:11:50   Epoch 7 end
23:11:50   ------------------------------
23:11:50   average binary cross entropy: 0.000396821
23:11:50   Save checkpoint to model_epoch_8.pth
23:11:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:11:50   Evaluate on valid (AUROC)
23:11:55   Valid AUROC: 0.878178
23:11:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:11:55   Epoch 8 begin
23:12:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:12:02   cross entropy: 0.000432314
23:12:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:12:23   Epoch 8 end
23:12:23   ------------------------------
23:12:23   average binary cross entropy: 0.000325512
23:12:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:12:23   Epoch 9 begin
23:12:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:12:35   cross entropy: 0.000101425
23:12:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:12:51   Epoch 9 end
23:12:51   ------------------------------
23:12:51   average binary cross entropy: 0.000244107
23:12:51   Save checkpoint to model_epoch_10.pth
23:12:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:12:51   Evaluate on valid (AUROC)
23:12:56   Valid AUROC: 0.878178
23:12:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:12:56   Epoch 10 begin
23:13:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:13:13   cross entropy: 0.000362071
23:13:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:13:24   Epoch 10 end
23:13:24   ------------------------------
23:13:24   average binary cross entropy: 0.000211055
23:13:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:13:24   Epoch 11 begin
23:13:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:13:46   cross entropy: 9.29553e-05
23:13:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:13:52   Epoch 11 end
23:13:52   ------------------------------
23:13:52   average binary cross entropy: 0.000160582
23:13:52   Save checkpoint to model_epoch_12.pth
23:13:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:13:52   Evaluate on valid (AUROC)
23:13:57   Valid AUROC: 0.882317
23:13:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:13:57   Epoch 12 begin
23:14:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:14:24   cross entropy: 0.000175698
23:14:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:14:25   Epoch 12 end
23:14:25   ------------------------------
23:14:25   average binary cross entropy: 0.00014777
23:14:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:14:25   Epoch 13 begin
23:14:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:14:53   Epoch 13 end
23:14:53   ------------------------------
23:14:53   average binary cross entropy: 0.000131439
23:14:53   Save checkpoint to model_epoch_14.pth
23:14:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:14:53   Evaluate on valid (AUROC)
23:14:58   Valid AUROC: 0.882317
23:14:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:14:58   Epoch 14 begin
23:15:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:15:02   cross entropy: 5.51244e-05
23:15:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:15:26   Epoch 14 end
23:15:26   ------------------------------
23:15:26   average binary cross entropy: 0.000104153
23:15:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:15:26   Epoch 15 begin
23:15:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:15:34   cross entropy: 6.07645e-05
23:15:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:15:54   Epoch 15 end
23:15:54   ------------------------------
23:15:54   average binary cross entropy: 9.07795e-05
23:15:54   Save checkpoint to model_epoch_16.pth
23:15:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:15:54   Evaluate on valid (AUROC)
23:15:59   Valid AUROC: 0.887639
23:15:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:15:59   Epoch 16 begin
23:16:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:16:12   cross entropy: 4.8673e-05
23:16:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:16:27   Epoch 16 end
23:16:27   ------------------------------
23:16:27   average binary cross entropy: 7.89756e-05
23:16:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:16:27   Epoch 17 begin
23:16:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:16:45   cross entropy: 3.17386e-05
23:16:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:16:55   Epoch 17 end
23:16:55   ------------------------------
23:16:55   average binary cross entropy: 8.03223e-05
23:16:55   Save checkpoint to model_epoch_18.pth
23:16:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:16:55   Evaluate on valid (AUROC)
23:17:00   Valid AUROC: 0.887639
23:17:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:17:00   Epoch 18 begin
23:17:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:17:23   cross entropy: 3.6939e-05
23:17:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:17:28   Epoch 18 end
23:17:28   ------------------------------
23:17:28   average binary cross entropy: 7.75e-05
23:17:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:17:28   Epoch 19 begin
23:17:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:17:56   Epoch 19 end
23:17:56   ------------------------------
23:17:56   average binary cross entropy: 6.96473e-05
23:17:56   Save checkpoint to model_epoch_20.pth
23:17:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:17:56   Evaluate on valid (AUROC)
23:18:01   Valid AUROC: 0.887639
23:18:01   Load checkpoint from model_epoch_16.pth
23:18:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:18:01   Evaluate on valid
23:18:06   Valid AUROC: 0.887639
23:18:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:18:06   Evaluate on test
23:18:11   Valid AUROC: 0.887639
