23:44:53   Random seed: 1024
23:44:53   Config file: config/transductive/inference.yaml
23:44:53   {'checkpoint': None,
 'dataset': {'class': 'RelBenchF1',
             'root': '/mnt/nfs/home/st191486/ULTRA/datasets/'},
 'model': {'class': 'Ultra',
           'entity_model': {'aggregate_func': 'sum',
                            'class': 'EntityNBFNet',
                            'hidden_dims': [64, 64, 64, 64, 64, 64],
                            'input_dim': 64,
                            'layer_norm': True,
                            'message_func': 'distmult',
                            'short_cut': True},
           'relation_model': {'aggregate_func': 'sum',
                              'class': 'RelNBFNet',
                              'hidden_dims': [64, 64, 64, 64, 64, 64],
                              'input_dim': 64,
                              'layer_norm': True,
                              'message_func': 'distmult',
                              'short_cut': True}},
 'optimizer': {'class': 'AdamW', 'lr': 0.0005},
 'output_dir': '/mnt/nfs/home/st191486/ULTRA/output/',
 'task': {'adversarial_temperature': 1,
          'metric': ['mr', 'mrr', 'hits@1', 'hits@3', 'hits@10'],
          'name': 'TransductiveInference',
          'num_negative': 0,
          'strict_negative': True},
 'train': {'batch_per_epoch': None,
           'batch_size': 16,
           'gpus': [0],
           'log_interval': 100,
           'num_epoch': 10}}
23:44:53   RelBenchF1 dataset
23:44:53   #train: 11411, #valid: 566, #test: 566
23:44:53   ------------------------------
23:44:53   Number of parameters: 185475
23:44:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:44:53   Epoch 0 begin
23:44:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:44:55   cross entropy: 1.27112
23:45:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:45:28   cross entropy: 0.0101136
23:46:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:46:01   cross entropy: 0.00899831
23:46:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:46:34   cross entropy: 0.00518859
23:47:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:47:06   cross entropy: 0.00244875
23:47:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:47:39   cross entropy: 0.00523805
23:48:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:48:12   cross entropy: 0.00253247
23:48:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:48:45   cross entropy: 0.0035295
23:48:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:48:49   Epoch 0 end
23:48:49   ------------------------------
23:48:49   average binary cross entropy: 0.0740558
23:48:49   Save checkpoint to model_epoch_1.pth
23:48:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:48:49   Evaluate on valid (AUROC)
23:48:54   Valid AUROC: 0.426159
23:48:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:48:54   Epoch 1 begin
23:49:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:49:23   cross entropy: 0.0165627
23:49:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:49:56   cross entropy: 0.000795883
23:50:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:50:29   cross entropy: 0.00309617
23:51:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:51:02   cross entropy: 0.00202098
23:51:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:51:35   cross entropy: 0.00819907
23:52:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:52:08   cross entropy: 0.00330571
23:52:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:52:41   cross entropy: 0.00278689
23:52:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:52:49   Epoch 1 end
23:52:49   ------------------------------
23:52:49   average binary cross entropy: 0.0357113
23:52:49   Save checkpoint to model_epoch_2.pth
23:52:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:52:49   Evaluate on valid (AUROC)
23:52:54   Valid AUROC: 0.835029
23:52:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:52:54   Epoch 2 begin
23:53:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:53:18   cross entropy: 0.00427141
23:53:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:53:51   cross entropy: 0.00371461
23:54:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:54:24   cross entropy: 0.288482
23:54:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:54:57   cross entropy: 0.00383715
23:55:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:55:30   cross entropy: 0.0107616
23:56:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:56:03   cross entropy: 0.00903467
23:56:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:56:36   cross entropy: 0.00940616
23:56:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:56:49   Epoch 2 end
23:56:49   ------------------------------
23:56:49   average binary cross entropy: 0.0410928
23:56:49   Save checkpoint to model_epoch_3.pth
23:56:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:56:49   Evaluate on valid (AUROC)
23:56:54   Valid AUROC: 0.873306
23:56:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:56:54   Epoch 3 begin
23:57:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:57:14   cross entropy: 0.238995
23:57:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:57:47   cross entropy: 0.0101956
23:58:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:58:20   cross entropy: 0.000534139
23:58:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:58:53   cross entropy: 0.000198339
23:59:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:59:25   cross entropy: 0.00206325
23:59:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:59:58   cross entropy: 9.462e-05
00:00:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:00:31   cross entropy: 7.92283e-05
00:00:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:00:49   Epoch 3 end
00:00:49   ------------------------------
00:00:49   average binary cross entropy: 0.00948786
00:00:49   Save checkpoint to model_epoch_4.pth
00:00:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:00:49   Evaluate on valid (AUROC)
00:00:54   Valid AUROC: 0.873306
00:00:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:00:54   Epoch 4 begin
00:01:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:01:09   cross entropy: 6.34063e-05
00:01:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:01:42   cross entropy: 3.90374e-05
00:02:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:02:15   cross entropy: 0.000386289
00:02:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:02:48   cross entropy: 5.13342e-06
00:03:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:03:21   cross entropy: 1.07511e-05
00:03:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:03:54   cross entropy: 6.42982e-06
00:04:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:04:27   cross entropy: 2.27987e-06
00:04:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:04:49   Epoch 4 end
00:04:49   ------------------------------
00:04:49   average binary cross entropy: 4.35188e-05
00:04:49   Save checkpoint to model_epoch_5.pth
00:04:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:04:49   Evaluate on valid (AUROC)
00:04:54   Valid AUROC: 0.873306
00:04:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:04:54   Epoch 5 begin
00:05:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:05:04   cross entropy: 5.58791e-06
00:05:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:05:37   cross entropy: 3.2857e-06
00:06:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:06:10   cross entropy: 3.82213e-06
00:06:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:06:43   cross entropy: 2.49594e-06
00:07:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:07:16   cross entropy: 2.83866e-06
00:07:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:07:49   cross entropy: 3.35275e-06
00:08:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:08:22   cross entropy: 2.99512e-06
00:08:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:08:49   Epoch 5 end
00:08:49   ------------------------------
00:08:49   average binary cross entropy: 4.24512e-06
00:08:49   Save checkpoint to model_epoch_6.pth
00:08:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:08:49   Evaluate on valid (AUROC)
00:08:54   Valid AUROC: 0.873306
00:08:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:08:54   Epoch 6 begin
00:09:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:09:00   cross entropy: 2.47359e-06
00:09:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:09:33   cross entropy: 1.74343e-06
00:10:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:10:06   cross entropy: 1.72108e-06
00:10:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:10:38   cross entropy: 9.84191e-06
00:11:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:11:11   cross entropy: 6.90644e-06
00:11:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:11:44   cross entropy: 2.27242e-06
00:12:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:12:17   cross entropy: 7.62921e-06
00:12:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:12:49   Epoch 6 end
00:12:49   ------------------------------
00:12:49   average binary cross entropy: 3.02022e-06
00:12:49   Save checkpoint to model_epoch_7.pth
00:12:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:12:49   Evaluate on valid (AUROC)
00:12:54   Valid AUROC: 0.873306
00:12:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:12:54   Epoch 7 begin
00:12:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:12:55   cross entropy: 1.44541e-06
00:13:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:13:28   cross entropy: 7.11505e-06
00:14:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:14:01   cross entropy: 3.68803e-06
00:14:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:14:34   cross entropy: 1.57207e-06
00:15:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:15:07   cross entropy: 2.6673e-06
00:15:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:15:40   cross entropy: 1.11759e-06
00:16:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:16:13   cross entropy: 1.17719e-06
00:16:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:16:45   cross entropy: 4.75338e-06
00:16:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:16:49   Epoch 7 end
00:16:49   ------------------------------
00:16:49   average binary cross entropy: 2.129e-06
00:16:49   Save checkpoint to model_epoch_8.pth
00:16:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:16:49   Evaluate on valid (AUROC)
00:16:54   Valid AUROC: 0.873306
00:16:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:16:54   Epoch 8 begin
00:17:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:17:23   cross entropy: 1.02073e-06
00:17:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:17:56   cross entropy: 9.61124e-07
00:18:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:18:29   cross entropy: 8.94069e-07
00:19:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:19:02   cross entropy: 1.58697e-06
00:19:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:19:35   cross entropy: 3.81463e-06
00:20:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:20:08   cross entropy: 1.22189e-06
00:20:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:20:41   cross entropy: 1.16974e-06
00:20:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:20:49   Epoch 8 end
00:20:49   ------------------------------
00:20:49   average binary cross entropy: 1.58324e-06
00:20:49   Save checkpoint to model_epoch_9.pth
00:20:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:20:49   Evaluate on valid (AUROC)
00:20:54   Valid AUROC: 0.873306
00:20:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:20:54   Epoch 9 begin
00:21:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:21:19   cross entropy: 3.37507e-06
00:21:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:21:52   cross entropy: 8.04662e-07
00:22:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:22:24   cross entropy: 5.2154e-07
00:22:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:22:57   cross entropy: 4.09777e-06
00:23:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:23:30   cross entropy: 1.05053e-06
00:24:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:24:03   cross entropy: 6.92903e-07
00:24:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:24:36   cross entropy: 8.64267e-07
00:24:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:24:49   Epoch 9 end
00:24:49   ------------------------------
00:24:49   average binary cross entropy: 1.13193e-06
00:24:49   Save checkpoint to model_epoch_10.pth
00:24:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:24:49   Evaluate on valid (AUROC)
00:24:54   Valid AUROC: 0.873306
00:24:54   Load checkpoint from model_epoch_3.pth
00:24:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:24:54   Evaluate on valid
00:24:59   Valid AUROC: 0.873306
00:24:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:24:59   Evaluate on test
00:25:04   Valid AUROC: 0.873306
